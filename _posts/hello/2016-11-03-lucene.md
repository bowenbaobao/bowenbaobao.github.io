---
layout: post
title: lucene 笔记
permalink: /:categories/lucene_url/
date: 2016-11-01 09:30:15 +0800
category: Java Search
tags: [lucene]
---



### Apache Lucene 4.10.4   JDK 1.7

####  meaven pom.xml  相关配置
```
<!-- org.apache.lucene 4.10.4 -->
		<dependency>
			<groupId>org.apache.lucene</groupId>
			<artifactId>lucene-core</artifactId>
			<version>4.10.4</version>
		</dependency>
		<dependency>
			<groupId>org.apache.lucene</groupId>
			<artifactId>lucene-analyzers-common</artifactId>
			<version>4.10.4</version>
		</dependency>
		<dependency>
			<groupId>org.apache.lucene</groupId>
			<artifactId>lucene-queryparser</artifactId>
			<version>4.10.4</version>
		</dependency>
		<dependency>
			<groupId>org.apache.lucene</groupId>
			<artifactId>lucene-highlighter</artifactId>
			<version>4.10.4</version>
		</dependency>
		<dependency>
			<groupId>org.apache.lucene</groupId>
			<artifactId>lucene-sandbox</artifactId>
			<version>4.10.4</version>
		</dependency>
		<dependency>
			<groupId>org.apache.lucene</groupId>
			<artifactId>lucene-queries</artifactId>
			<version>4.10.4</version>
		</dependency>
		<dependency>
			<groupId>org.apache.lucene</groupId>
			<artifactId>lucene-memory</artifactId>
			<version>4.10.4</version>
		</dependency>
		<dependency>
			<groupId>org.apache.lucene</groupId>
			<artifactId>lucene-codecs</artifactId>
			<version>4.10.4</version>
		</dependency>
		<dependency>
			<groupId>org.apache.lucene</groupId>
			<artifactId>lucene-analyzers-icu</artifactId>
			<version>4.10.4</version>
		</dependency>
```

####  ik 手工配置
```
		<dependency>
			<groupId>org.wltea</groupId>
			<artifactId>IKAnalyzer</artifactId>
			<version>IKAnalyzer2012FF_u1</version>
		</dependency>
```
IK包名:IKAnalyzer-IKAnalyzer2012FF_u1.jar


#### java 代码块

##### SearchConstant.java   全局配置类

```
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.util.Properties;
import org.apache.lucene.document.DoubleField;
import org.apache.lucene.document.FieldType;
import org.apache.lucene.document.FloatField;
import org.apache.lucene.document.IntField;
import org.apache.lucene.document.LongField;
import org.apache.lucene.index.FieldInfo.IndexOptions;
import org.apache.lucene.util.Version;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

/**
 * @describe 系统常量类
 * @author bowen_bao
 * @date 2015年9月8日
 */
public class SearchConstant {
	
	 private static Logger logger = LoggerFactory.getLogger(SearchConstant.class);
		  
	 //搜索index path
	 public final static String ECNEW_INDEX_PATH="/opt/searchIndex/ecnew";        //服务器搜索索引库地址
	 
	 //搜索lucene版本
	 public final static Version SYS_LUCENE_VERSION=Version.LUCENE_4_10_4;
	 
	 //搜索高亮标签
	 public final static String HIGHLIGHT_BEGIN="<font color='#ec6a00'>"; 
	 public final static String HIGHLIGHT_END="</font>";
	
	 //定义索引的数据格式
	public static final FieldType STORE_YES_ANALYZED=new FieldType();//存储、分词
	public static final FieldType STORE_YES_ANALYZED_NO=new FieldType();//存储，不分词
	public static final FieldType STORE_YES_INDEX_NO=new FieldType();//存储，不索引
	public static final FieldType STORE_NO_ANALYZED=new FieldType();//不存储，分词
	public static final FieldType STORE_NO_ANALYZED_NO=new FieldType();//不存储，不分词
	
	public static final FieldType STORE_YES_INT=IntField.TYPE_STORED;//Int 存储
	public static final FieldType STORE_YES_LONG=LongField.TYPE_STORED;//Long 存储
	public static final FieldType STORE_YES_FLOAT=FloatField.TYPE_STORED;//Float 存储
	public static final FieldType STORE_YES_DOUBLE=DoubleField.TYPE_STORED;//Double存储
		
		
		static{
			STORE_YES_ANALYZED.setStored(true);
			STORE_YES_ANALYZED.setIndexed(true);
			STORE_YES_ANALYZED.setTokenized(true);//分词
			STORE_YES_ANALYZED.setOmitNorms(false);//是否忽略加权基准值     true:忽略    false:不忽略      加权基准值:长度标准化因子、字段权重
			/**
			    IndexOptions  修改倒排索引属性
				IndexOptions.DOCS_ONLY  documemts被索引，词频和位置被忽略
				IndexOptions.DOCS_AND_FREQS   documents、词频被索引，term位置被忽略    对field短语或有关位置的查询会抛异常
				IndexOptions.DOCS_AND_FREQS_AND_POSITIONS  全文索引的默认设置：打分、位置检索都支持
				IndexOptions.DOCS_AND_FREQS_AND_POSITIONS_AND_OFFSETS  索引字符相对位置的偏移量
			 */
			STORE_YES_ANALYZED.setIndexOptions(IndexOptions.DOCS_AND_FREQS_AND_POSITIONS);
			STORE_YES_ANALYZED.freeze(); //阻止field属性未来可能的变更
			
			
			STORE_YES_ANALYZED_NO.setStored(true);
			STORE_YES_ANALYZED_NO.setIndexed(true);
			STORE_YES_ANALYZED_NO.setTokenized(false);
			STORE_YES_ANALYZED_NO.setOmitNorms(false);
			STORE_YES_ANALYZED_NO.setIndexOptions(IndexOptions.DOCS_AND_FREQS_AND_POSITIONS);
			STORE_YES_ANALYZED_NO.freeze();
			
			
			STORE_YES_INDEX_NO.setStored(true);
			STORE_YES_INDEX_NO.setIndexed(false);
			STORE_YES_INDEX_NO.setTokenized(false);
			STORE_YES_INDEX_NO.setOmitNorms(true);
			STORE_YES_INDEX_NO.setIndexOptions(null);//只存储，不索引，无倒排索引属性
			STORE_YES_INDEX_NO.freeze();
			
			
			STORE_NO_ANALYZED.setStored(false);
			STORE_NO_ANALYZED.setIndexed(true);
			STORE_NO_ANALYZED.setTokenized(true);
			STORE_NO_ANALYZED.setOmitNorms(false);
			STORE_NO_ANALYZED.setIndexOptions(IndexOptions.DOCS_AND_FREQS_AND_POSITIONS);
			STORE_NO_ANALYZED.freeze();
			
			STORE_NO_ANALYZED_NO.setStored(false);
			STORE_NO_ANALYZED_NO.setIndexed(true);
			STORE_NO_ANALYZED_NO.setTokenized(false);
			STORE_NO_ANALYZED_NO.setOmitNorms(false);
			STORE_NO_ANALYZED_NO.setIndexOptions(IndexOptions.DOCS_AND_FREQS_AND_POSITIONS);
			STORE_NO_ANALYZED_NO.freeze();
			
		}
		
		
		//indexReader刷新器时间
		public static final long INDEXREADER_SLEEP_TIME=1*1000L;
			    
		 
		
}

```






